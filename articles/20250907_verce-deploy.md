---
title: "Vercelã®æ©Ÿèƒ½ã‚’æ´»ç”¨ã—ã¦ãƒ–ãƒ©ãƒ³ãƒé‹ç”¨ã‚’ã‚·ãƒ³ãƒ—ãƒ«ã«ã™ã‚‹"
emoji: "ðŸ¤–"
type: "tech"
topics: ["vercel"]
published: false
publication_name: "yoshinani_dev"
---


> ã“ã®è¨˜äº‹ã¯ã€ŒYOSHINANI&ã­ã“ã­ã“ãƒ‘ãƒ©ãƒ€ã‚¤ã‚¹ Advent Calendar 2025ã€ã®8æ—¥ç›®ã§ã™ã€‚https://adventar.org/calendars/12110

æ ªå¼ä¼šç¤¾YOSHINANIã®ãµã£ã‘ã§ã™ã€‚
ä»Šå›žã¯ã€**Vercelã®æ©Ÿèƒ½ã‚’æ´»ç”¨ã—ã¦ãƒ–ãƒ©ãƒ³ãƒé‹ç”¨ã‚’ã‚·ãƒ³ãƒ—ãƒ«ã«ã™ã‚‹**æ–¹æ³•ã‚’ç´¹ä»‹ã—ã¾ã™ã€‚

ã“ã®è¨˜äº‹ã‚’èª­ã‚€ã“ã¨ã§ã€è¤‡é›‘ãªãƒ–ãƒ©ãƒ³ãƒé‹ç”¨ã‹ã‚‰è§£ãæ”¾ãŸã‚Œã€mainãƒ–ãƒ©ãƒ³ãƒã¨featureãƒ–ãƒ©ãƒ³ãƒã®ã¿ã®ã‚·ãƒ³ãƒ—ãƒ«ãªãƒ–ãƒ©ãƒ³ãƒé‹ç”¨ã‚’å§‹ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## å‰æ
ä¸‹è¨˜ã®ç’°å¢ƒãŒã‚ã‚‹ã“ã¨ã‚’æƒ³å®šã—ã¾ã™ã€‚

- Production
- Staging
- Develop

## ãƒ–ãƒ©ãƒ³ãƒåˆ†ã‘ã«ã‚ˆã‚‹æ–¹æ³•
ã‚ˆãã‚ã‚‹ãƒ–ãƒ©ãƒ³ãƒåˆ†ã‘ã«ã‚ˆã‚‹æ–¹æ³•ã§ã¯ã€ç’°å¢ƒã”ã¨ã«ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆã—ãã®ãƒ–ãƒ©ãƒ³ãƒã¸ã®ãƒžãƒ¼ã‚¸ã«ã‚ˆã£ã¦ç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’è¡Œã„ã¾ã™ã€‚

ã“ã‚Œã®èª²é¡Œã¨ã—ã¦ã¯ã€
- æœ¬ç•ªåæ˜ ã—ã‚ˆã†ã¨ã—ã¦mainã«ãƒžãƒ¼ã‚¸ã—ãŸã‚‰mainã®ç’°å¢ƒå¤‰æ•°ã®ã¨ãã ã‘CIãŒè½ã¡ãŸ
- mainã«ãƒžãƒ¼ã‚¸ã—ã‚ˆã†ã¨ã—ãŸã‚‰ãªãœã‹ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆãŒç™ºç”Ÿã—ã¦ã„ã‚‹
- Productionã§ä¸å…·åˆãŒã‚ã£ãŸã¨ãã«ã€hotfixãƒ–ãƒ©ãƒ³ãƒã‚’productionã«å½“ã¦ãŸå¾Œã€stagingã‚„developã«ã‚‚å½“ã¦ã‚‹å¿…è¦ãŒã‚ã‚Šã“ã®éŽç¨‹ã§ã‚‚ã‚³ãƒ³ãƒ•ãƒªã‚¯ãƒˆãŒç™ºç”Ÿã—ã†ã‚‹

ãªã©ãŒåƒ•ãŒä½“é¨“ã—ãŸé–‹ç™ºã§ã¯ã‚ã‚Šã¾ã—ãŸã€‚

æ¬¡ã«Vercelã‚’ä½¿ã£ãŸç’°å¢ƒã®ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³•ã§ã™ã€‚

## Vercelã‚’ä½¿ã£ãŸæ–¹æ³•
### ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®æ§‹ç¯‰
Vercelã®ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ç’°å¢ƒå®šç¾©ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ã€‚

| ç’°å¢ƒå | ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³• |
| --- | --- |
| Production | main branchã‚’ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã—è‡ªå‹•ã§ãƒ‡ãƒ—ãƒ­ã‚¤ |
| Development | CLIçµŒç”± |
| Preview | PRã”ã¨ã«ä½œæˆã•ã‚Œã‚‹ |




## Vercelã®ãƒ–ãƒ©ãƒ³ãƒé‹ç”¨ã«ã¤ã„ã¦

| å·®åˆ† | ç’°å¢ƒå | ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹æ³• |
| --- | --- | --- |
| edit | Production | Auto-assign Custom Production Domainsã‚’å¤–ã™ |
| add | Staging | main branchã®ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚° |

ã¾ãšã€Stagingç’°å¢ƒã‚’æ–°ãŸã«ä½œæˆã—ã€main branchã‚’ãƒˆãƒ©ãƒƒã‚­ãƒ³ã‚°ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚
ã“ã‚Œã«ã‚ˆã£ã¦mainã«ãƒžãƒ¼ã‚¸ã•ã‚ŒãŸæœ€æ–°ã®ã‚³ãƒ¼ãƒ‰ãŒStagingç’°å¢ƒã«åæ˜ ã•ã‚Œã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

æ¬¡ã«Productionç’°å¢ƒã®Auto-assign Custom Production Domainsã‚’å¤–ã—ã¾ã™ã€‚
ã“ã‚Œã«ã‚ˆã£ã¦ã€mainã«ãƒžãƒ¼ã‚¸æ™‚ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã¯ä½œæˆã•ã‚Œã¾ã™ãŒã€æœ¬ç•ªãƒ‰ãƒ¡ã‚¤ãƒ³ã«ã‚¢ã‚¿ãƒƒãƒã•ã‚Œã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

ãã‚Œã§å‹•ä½œç¢ºèªå¾Œã€Vercelä¸Šã§Promote to Productionãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ä»»æ„ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã‚’æœ¬ç•ªURLã«ã‚¢ã‚¿ãƒƒãƒã§ãã‚‹ã€‚

æœ¬ç•ªã§äº‹æ•…ã£ãŸã‚‰ Instant Rollback ã§å³åº§ã«éŽåŽ»ã®æœ¬ç•ªãƒ‡ãƒ—ãƒ­ã‚¤ã¸æˆ»ã™ã“ã¨ã‚‚ã§ãã‚‹ã€‚


## æ©Ÿèƒ½è¿½åŠ ã«ã©ã†å¯¾å¿œã™ã‚‹ã‹
mainãƒ–ãƒ©ãƒ³ãƒã«featureã‚’ãƒžãƒ¼ã‚¸ã™ã‚‹æˆ¦ç•¥ã®ã¨ãã«ã€é–‹ç™ºä¸­ã®æ©Ÿèƒ½ã®ã‚³ãƒ¼ãƒ‰ãŒå«ã¾ã‚Œã‚‹ã®ã‚’ã©ã†ã™ã‚‹ã®ã‹ã¨ã„ã†èª²é¡ŒãŒã‚ã‚Šã¾ã™ã€‚

Feature Flagã‚’æ´»ç”¨ã™ã‚‹ã‚¢ãƒ—ãƒ­ãƒ¼ãƒãŒè‰¯ã„ã§ã™ã€‚
Vercelã®Edge Configæ©Ÿèƒ½ã‚’ä½¿ã†ã¨Feature Flagé‹ç”¨ãŒå¯èƒ½ã§ã™ã€‚

è©³ç´°ãªè§£èª¬ã¯çœãã¾ã™ãŒä¸‹è¨˜ã®ã‚ˆã†ãªã‚³ãƒ¼ãƒ‰ã¨ã€Vercelä¸Šã®è¨­å®šã§Feature Flagã‚’åˆ©ç”¨ã§ãã¾ã™ã€‚
Feature Flagã‚’ä½¿ã£ã¦é–‹ç™ºä¸­ã®æ©Ÿèƒ½ã«ã¤ã„ã¦ã¯å‹•ä½œã—ãªã„ã‚ˆã†ã«æ¡ä»¶åˆ†å²ã™ã‚‹ã“ã¨ã§ã€é–‹ç™ºé€”ä¸­ã®ã‚³ãƒ¼ãƒ‰ã‚‚mainãƒ–ãƒ©ãƒ³ãƒã«å«ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
ã¾ãŸãƒ“ãƒƒã‚°ãƒãƒ³ãƒªãƒªãƒ¼ã‚¹ã‚’é˜²ãã“ã¨ãŒã§ãã¾ã™ã€‚

```ts:get-flag.ts
"server-only"

import { get } from "@vercel/edge-config"

const getFlag = (flag: string) => {
  return get(flag)
}

export const getFeatureAFlag = () => getFlag("isFeatureAEnable")
```

![](https://storage.googleapis.com/zenn-user-upload/5fd6125cf35c-20251207.png)
![](https://storage.googleapis.com/zenn-user-upload/10581107d755-20251207.png)
![](https://storage.googleapis.com/zenn-user-upload/1c93ed3ec859-20251207.png)
![](https://storage.googleapis.com/zenn-user-upload/f3939f40c6a8-20251207.png)